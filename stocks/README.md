# 股票投资

## 一. 预测什么
* 做多机制下，主要关注股票的涨幅，而跌幅作为防御指标需要作为选股时的参考。
* 结论：分别预测一只股票未来n天的最高涨/跌幅度。分母为明日开盘价(考虑到涨停板可能是无法买入的),分子为未来5天最高、最低价。
  * n=2,3,5? 考虑到不能t+0,最低是预测未来2天的价格，如果太大，在拆分数据上，会出现训练、测试集出现交叉的情况？
* stock_no,date,future_5_highest,future_5_lowest. 这部分数据比较独立，可分开存储。

* 周期
  * 大趋势的判断：7~8年(上证指数的峰值间距？)是一个中国股市牛熊转换的完整周期？ 
  未来2 ~ 3年处在什么位置？
  * 中期：半年
  * 短期： 一周？
* 板块?
* 个股?
* 选股策略：未来n天的股票涨跌幅？n=5 ?
* 交易策略：w

## 二、思路
1. point-wise， 回归问题，绝对的涨跌幅。一般不选择这个
2. pair-wise，pair对二分类问题。根据涨跌幅排序，一般采用这个。
3. list-wise ，排序

## 三、特征
1. 过去n天的交易数据，n=20，一个月的？
2. 最高价、最低价、开盘价、收盘价、成交量、成交金额
3. 如何归一化，价格取过去1年(4种价格放在一起,仅开盘价?)中位数(可实际看看中位数与均值差别是否较大)？做最大最小值归一；同理，成交量，成交金额类似。
4. 每天的数据归一化后看成一个向量，过去n天数据看成一个矩阵；和RNN/Transformers的输入保持一致；
5. 训练集、验证集、测试集的划分：以要预测的为基准，保证三个集合中不能重复。每周训练一次。历史模型要保留，须做效果回归验证。
6. stock_no,date,base_price,base_x,base_,day20,day19...

1. 统计思路，
    1. 每一只股票全部的最高、最低、中位数、四分数？ 
    1. 一段时间的最高、最低，中位数，四分位数？
    1. 成交量
    1. 成交金额？

ETF？
* [深市ETF](http://www.szse.cn/market/product/list/etfList/index.html)
* [沪市ETF](http://www.sse.com.cn/assortment/fund/etf/list/)
 

1. label如何分档，分几档？
a. 完全平均分，每个层级档位均匀；尝试分10档，20档？  
b. 先平均分4分，top部分再接着分4分?

分6档？
label   分位  high   low
6 75%  0.153396  -0.005885
5 50%  0.108310  -0.016234 
4 25%  0.086307  -0.034516
3 75%  0.07      -0.014298
2 50%  0.03      -0.032202
1 25%  0.01      -0.060422


2. 分组方式
a. 完全随机分组
b. 按日期分组

3. 每组样本构造
如何能找到比较涨幅较高的？

top10,


## 特征
过去20天最高、最低价，距离最高最低家的天数，过去5天收盘价，成交量，成交金额


使用sqlite，按日期、按股票筛选，速度更快些？


## 流程
1. 下载更新数据
2. 训练更新模型、发出评估结论
3. 预测未来一周情况



preprocess.py:105: RuntimeWarning: invalid value encountered in double_scalars
  (df_past.loc[i]['TURNOVER'] - mean_TURNOVER)/mean_TURNOVER)